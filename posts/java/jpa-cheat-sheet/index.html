<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Jpa Cheat Sheet for annotations | Derry Dev Blog</title><meta name=keywords content="jpa,java,database,annotations,cheat sheet,data,persistence,table"><meta name=description content="Entity @Entity - marks class as the database entity @Entity public class Pokemon{} @Table - table name @Table(name = &#34;Poke&#34;) public class Pokemon { } @Id - mark the primary key Annotate primary key
@Id private int id; @GeneratedValue - the strategy for primary key GenerationType
@Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; GenerationType.IDENTITY The database is set AUTO_INCREMENT.
Similar to SQL id NOT NULL AUTO_INCREMENT
GenerationType.SQUENCE GenerationType.TABLE Use the TABLE in database to set the primary key for us, instead of the DBMS system."><meta name=author content="Derry"><link rel=canonical href=https://derry.club/posts/java/jpa-cheat-sheet/><meta name=google-site-verification content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href="https://github.com/derrykid/blogs-repo/blob/main/img/logo.png?raw=true"><link rel=icon type=image/png sizes=16x16 href=https://derry.club/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://derry.club/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://derry.club/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://derry.club/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PRN40V7XPE"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PRN40V7XPE",{anonymize_ip:!1})}</script><meta property="og:title" content="Jpa Cheat Sheet for annotations"><meta property="og:description" content="Entity @Entity - marks class as the database entity @Entity public class Pokemon{} @Table - table name @Table(name = &#34;Poke&#34;) public class Pokemon { } @Id - mark the primary key Annotate primary key
@Id private int id; @GeneratedValue - the strategy for primary key GenerationType
@Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; GenerationType.IDENTITY The database is set AUTO_INCREMENT.
Similar to SQL id NOT NULL AUTO_INCREMENT
GenerationType.SQUENCE GenerationType.TABLE Use the TABLE in database to set the primary key for us, instead of the DBMS system."><meta property="og:type" content="article"><meta property="og:url" content="https://derry.club/posts/java/jpa-cheat-sheet/"><meta property="og:image" content="https://derry.club/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-15T18:52:27+00:00"><meta property="article:modified_time" content="2023-01-15T18:52:27+00:00"><meta property="og:site_name" content="Derry Dev Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://derry.club/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Jpa Cheat Sheet for annotations"><meta name=twitter:description content="Entity @Entity - marks class as the database entity @Entity public class Pokemon{} @Table - table name @Table(name = &#34;Poke&#34;) public class Pokemon { } @Id - mark the primary key Annotate primary key
@Id private int id; @GeneratedValue - the strategy for primary key GenerationType
@Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; GenerationType.IDENTITY The database is set AUTO_INCREMENT.
Similar to SQL id NOT NULL AUTO_INCREMENT
GenerationType.SQUENCE GenerationType.TABLE Use the TABLE in database to set the primary key for us, instead of the DBMS system."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://derry.club/posts/"},{"@type":"ListItem","position":2,"name":"Jpa Cheat Sheet for annotations","item":"https://derry.club/posts/java/jpa-cheat-sheet/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Jpa Cheat Sheet for annotations","name":"Jpa Cheat Sheet for annotations","description":"Entity @Entity - marks class as the database entity @Entity public class Pokemon{} @Table - table name @Table(name = \u0026#34;Poke\u0026#34;) public class Pokemon { } @Id - mark the primary key Annotate primary key\n@Id private int id; @GeneratedValue - the strategy for primary key GenerationType\n@Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; GenerationType.IDENTITY The database is set AUTO_INCREMENT.\nSimilar to SQL id NOT NULL AUTO_INCREMENT\nGenerationType.SQUENCE GenerationType.TABLE Use the TABLE in database to set the primary key for us, instead of the DBMS system.","keywords":["jpa","java","database","annotations","cheat sheet","data","persistence","table"],"articleBody":"Entity @Entity - marks class as the database entity @Entity public class Pokemon{} @Table - table name @Table(name = \"Poke\") public class Pokemon { } @Id - mark the primary key Annotate primary key\n@Id private int id; @GeneratedValue - the strategy for primary key GenerationType\n@Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; GenerationType.IDENTITY The database is set AUTO_INCREMENT.\nSimilar to SQL id NOT NULL AUTO_INCREMENT\nGenerationType.SQUENCE GenerationType.TABLE Use the TABLE in database to set the primary key for us, instead of the DBMS system.\nIn database, I’ve created a table named key_generator. There are 2 columns in it:\nkey_name next_val // // @Id @GeneratedValue(strategy = GenerationType.TABLE, generator = \"key_generator\") private int id; The default column name of the value is next_val.\nCustomize the generator by @TableGenerator To achieve this table: key_generator\nkey_name key_value product_sequence 150 We have to use the @TableGenerator:\n@Id @TableGenerator(name = \"key_generator\", table = \"key_generator\", pkColumnName = \"key_name\", pkColumnValue = \"product_sequence\", valueColumnName = \"key_value\", allocationSize = 20) @GeneratedValue(strategy = GenerationType.TABLE, generator = \"key_generator\") private int id; Generator For primary key, we can use a custom generator like @GenericGenerator provided by hibernate.\n@GenericGenerator There are several generators available. This one is an example.\n@Id @GenericGenerator( name = \"uuid\", strategy = \"org.hibernate.id.UUIDHEXGenerator\", parameters = @Parameter(name = \"separator\", value = \"-\") // this is optional ) @GeneratedValue(generator = \"uuid\") private String id; @Column - name in database @Column(name = \"xxx\") - column name It’s used to relate the name in database.\nFor example, when we create a database in app:\n@Entity @Data public class Pokemon { @Column(name = \"Special-Attack\") private int specialAttack; } This will set the name of column in database for “Special-Attack”, if not set, it will set as the field name;\n@Column(table = \"xxx\") - table name It can be used at when work with relationships.\n@Entity @Data @Table(name = \"Company\") @SecondaryTable(name = \"address\", pkJoinColumns = @PrimaryKeyJoinColumn(name = \"company_fk\")) public class Company { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String name; @Column(table = \"address\") private String street; @Column(table = \"address\") private String road; } @Enumerated - set the presentation of Enum value in database At field, we might use enum to set the field. Use the @Enumerated annotation\n@Entity @Data public class Price { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private double amount; @Enumerated(value = EnumType.ORDINAL) private Currency currency; // enum type } public enum Currency { EUR, USD } @Enumerated default sets to ordinal value, however there is alternative:\n@Enumerated(EnumType.ORDINAL) - default @Enumerated(EnumType.STRING) Different setting to changes the database table:\nid: int amount:double currency: (int or varchar) 1 10 0 (EUR, if set ordinal) 2 30 USD(set String) @Temporal For saving the time, JPA has implemented automatically, so we don’t have to use this @Temporal annotation unless we use the legacy package Data.class.\nWe can just use this, the implementation will help us persist the data:\n@Entity @Data public class Event { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; @Column(name = \"event_time\") private LocalDate eventTime; // or ZonedDateTime; } In database:\nid event_time: DATE 1 2020-12-22 We can also use timestamp to store the data. Note that whichever you choose, ZonedDateTime or LocalDateTime, the data saved in database is the same.\n@Embedded, @Embeddable - 1 database table for 2 java object We can use this to persist an object in our entity. For example we have a company table like this:\nid name no. street city 1 Water Corp. 12 Oak street London We saved the address separately. On the other hand, for OOP point of view, we should save it as an object like this:\n@Entity @Data public class Company { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String name; @Embedded private Address address; } @Data @Embeddable public class Address { private String number; private String street; private String city; } This way, when we create an instance of company, we can persist it and commit in database in OOP way.\nIf the column name doesn’t match field name - use @AttributeOverride @Data @Embeddable public class Address { private String no; private String strt; private String city; } For this, the database can’t match the field name. We have to use @AttributeOverride in company class to specify the change:\npublic class company { // fields @Embedded @AttributeOverride(name = \"no\", column = @Column(name = \"number\")) @AttributeOverride(name = \"strt\", column = @Column(name = \"street\")) private Address address; } Or use the @AttributeOverrides to group these:\n@AttributeOverrides{ @AttributeOverride(name = \"no\", column = @Column(name = \"number\")), @AttributeOverride(name = \"strt\", column = @Column(name = \"street\")) } private Address address; AssociationOverride – need attention For rare cases, this can used to substitute @AttributeOverride. But this increase the complexity.\nComposite primary key - @IdClass(class) Composite key is that there is 2 primary key in the table:\nDepartment table\ncode:pk id:pk name C132 S23 a C132 S24 b We have to create 2 classes to implement this: note the @IdClass(), and 2 @Id on the fields.\n@Entity @Data @IdClass(DepartmentPK.class) @Table(name = \"department\") public class Department { @Id private String code; @Id private String id; private String name; } // composite key class @Data public class DepartmentPK implements Serializable { private String code; private String id; } Probably the implements Serializable is not mandatory anymore, cuz when I remove it, the code still works.\nAlternative to @IdClass() for composite primary key: @EmbeddedId @Data @Entity public class Building { @EmbeddedId private BuildingPK id; // more fileds } @Data @Embeddable public class BuildingPK implements Serializable { private int number; private String code; } Create a third class and annotate with @Embeddable to create composite key Student table\nstudent_id name grade 1 John 1 Subject table\nsubject_id name 101 English marks table\nsubject_id student_id mark 101 1 75 The marks table have a composite key made of subject_id and student_id.\nWe can create a third class to do it\npublic class Student { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"student_id\") private Long id; // fields } --------- public class Subject { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = \"subject_id\") private Long id; // fields } ---------- @Entity @Data @Table(name = \"student_marks\") public class StudentMark { @EmbeddedId private StudentMarkId markId; private int mark; } ----------- @Embeddable @Data public class StudentMarkId implements Serializable { @ManyToOne(cascade = CascadeType.ALL) @JoinColumn(name = \"student_id\") private Student student; @ManyToOne(cascade = CascadeType.ALL) @JoinColumn(name = \"subject_id\") private Subject subject; } Note that StudentMarkId is a @Embeddable. It works as an composite key. To save it to repository, we have to do an interface as well:\npublic interface StudentMarkRepository extends JpaRepository\u003cStudentMark, StudentMarkId\u003e { } The JpaRepository ID field is the embedded id.\nThis is how client calls it:\n@Bean public CommandLineRunner run(StudentRepository studentRepository, SubjectRepository subjectRepository, StudentMarkRepository studentMarkRepository) { return args -\u003e { Student jack = new Student(); jack.setName(\"jack\"); jack.setGrade(1); studentRepository.save(jack); Subject english = new Subject(); english.setName(\"English\"); subjectRepository.save(english); StudentMarkId id = new StudentMarkId(); id.setStudent(jack); id.setSubject(english); StudentMark mark = new StudentMark(); mark.setMark(75); mark.setMarkId(id); studentMarkRepository.save(mark); }; } Seldom use - @Access to specify access the field or by getter Default is by field: @Access(AccessType.FIELD)\n@Data @Entity @Access(AccessType.PROPERTY) public class Person { private int id; private String name; @Id @GeneratedValue(strategy = GenerationType.IDENTITY) public int getId() { return id; } } Relationships @JoinColumn to config the default foreign key name By default, the foreign key naming is product_id, in form of table_id.\nYou can change that by:\n@JoinColumn(name = \"product_fk\") @OneToOne private Product product; Relationship annotation with its attribute fields Relationship annotations\n@OneToOne @OneToMany @ManyToOne @ManyToMany targetEntity This is used to specify the target class, and works with polymorphism.\nThis example Object is set as field type, but it’s too vague, we want a more specific class.\n@OneToMany(targetEntity = className.class) private Object field; cascade attribute It’s often that when we persist one object in database, it’s associated with another object.\nThe trainer has a pokemon pikachu, to persist trainer we also have to persist pikachu.\npokeMonRepository.save(pikachu); trainerRepository.save(trainer); Cascade is the way to specify the behaviour of this.\npublic class Trainer { @OneToOne(cascade = CascadeType.ALL) private Pokemon pokemon; } public class Pokemon { // ... } PERSIST - The operations cascade to related entities. If only save trainer, pikachu is also saved REMOVE - Similar to PERSIST but this is delete. If remove the trainer, the pikachu is also removed! REFRESH - is to refresh the data in the object. Perhaps there was a change on the database which needs to be synced. MERGE - propagate the operation from one to another. If pikachu changes its data, the trainer whose hold it as the instance variable will also flush the value. It’s not in database layer. ALL - all of above. Set to all isn’t always making the program run well. See: detached entity exception There are more types to select from.\nOrphan removal vs CascadeType.REMOVE While REMOVE remove all related entities. The orphanRemoval provides a smart way to remove a record based on relationship.\nA trainer can take 6 pokemon on journey. We call it partyPokemons here.\nTrainer trainer = repository.findById(Trainer.class, 1); Set\u003cPokemon\u003e partyPokemons = trainer.getPartyPokemon(); partyPokemons.remove(xxx); // we remove one pokemon, in collection Now that in the party, trainer have 5 pokemon, and remove 1 from the collection. That removed one is an orphan. That orphan entity will be removed from the database, even though we did not use any delete operation.\nfetch - fetch all related info or not FetchType.EAGER - fetch all info of the object fields, includes other table FetchType.LAZY - fetch the info only when we need it. Better specify the value, cuz the default depends on the annotations @OneToOne( fetch = FetchType.EAGER ) mappedBy To specify the bidirectional model. It’s used at the owned side.\n@OneToMany(mappedBy = \"fieldNameInAnotherClass\") private Document doc; optional - default true By default, this allows us to make one field optional. Like in Detail field product, we set product, but the product detail can be null.\nIf you want to make sure it always have value:\n@OneToOne(optional = false) OneToOne By @OneToOne: unidirectional - only use this annotation at one class Unidirectional: in this case, only Detail knows the product object.\nProduct table\nid name price 1 beer 10 Detail table, the foreign key must named this way product_id. If want to config this, see @JoinColumn\nid kcal product_id 101 200 1 @Data @Entity public class Product { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String name; private double price; } @Data @Entity public class Detail { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private int kcal; @OneToOne private Product product; } @OneToOne - bidirectional - use this annotations at 2 class Not all cases need bidirectional, it will have overheads as well. Think if you really need it.\nIf you want to map it bidirectional:\npublic class Detail { // some fileds @OneToOne private Product productField; } public class product { // some fields @OneToOne(mappedBy = \"productField\") private Detail detail; } In this case, Detail class is considered the owner of the relationship. So the other side product must use mappedBy value.\nBy @SecondaryTable, no need to use @OneToOne Table company\nid name 5 A Corp Table address\nid road street company_fk 1 Oak Sky street 5 In table address, there’s a foreign key company_fk. It actually is the constrain key with table company.\nWe can use a class to achieve this:\n@Entity @Data @Table(name = \"Company\") @SecondaryTable(name = \"address\", pkJoinColumns = @PrimaryKeyJoinColumn(name = \"company_fk\")) public class Company { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String name; @Column(table = \"address\") private String street; @Column(table = \"address\") private String road; } There is an annotation SecondaryTable on top of the class, specify the name of SecondaryTable. Besides, it points out the foreign key: company_fk.\nIn the field, it also specifies @Column(table = \"address\").\nOneToMany Create the third table named after other tables’ name A department can have many employees. An employee belongs to one department.\n@Entity @Data @Table(name = \"department\") public class Department { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String name; @OneToMany private List\u003cEmployee\u003e employee; // this must match the name // of column in department_employee } --------------------------- @Entity @Data @Table(name = \"employee\") public class Employee { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String name; } For this to work, we have to create the 3rd table department_employee.\nTable department_employee\ndepartment_id employee_id // // don’t have to create 3rd table One person can have many documents\nDocument table:\nid person_id 1 1 2 1 @Entity @Data public class Person { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String name; } -------------------- @Entity @Data public class Document { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; @ManyToOne private Person person; } Use Collection to store a collection of entities, bidirectional example Take the Person class for example:\n@Entity @Data public class Person { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String name; @OneToMany(mappedBy = \"person\") private Collection\u003cDocument\u003e documents; } This can save multiple documents at a time\nManyToMany - @JoinTable unidirectional - only one knows the other One professor may have multiple students, and one student may have multiple professors.\nProfessor table: id, name Student table: id, name public class Professor { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String name; @ManyToMany @JoinTable(name = \"professor_student\", // table name, this value here is the default value joinColumns = @JoinColumn(name = \"professor\"), // column name, suppose to be professor_id inverseJoinColumns = @JoinColumn(name = \"student\") // the other column name ) private List\u003cStudent\u003e students; } ------------------------ public class Student { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String name; } bidirectional Annotated student class\npublic class Student { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String name; @ManyToMany(mappedBy = \"students\") // the field name in the Professor class private List\u003cProfessor\u003e professors; } @ElementCollection - mark a non-entity object It’s used to mark something that wasn’t created as entity. For example, we have a person table, and a phone table\nmap a non-entity class Person\nid name 1 John phone\nnumber person 312 1 We did not create a entity class phone, we save it as a String in a list.\nThe @ElementCollection is in used here to mark a non-entity class.\n@Entity public class Person { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String name; @ElementCollection @CollectionTable(name = \"phone\", joinColumns = @JoinColumn(name = \"person\")) @Column(name = \"number\") private List\u003cString\u003e phoneNumbers; } map @Embeddable It can also to map an Embeddable class\nDocument table:\ncover reference person ——- ———– ——– @Entity public class Person { // other fields @ElementCollection @CollectionTable(name = \"document\", joinColumns = @JoinColumn(name = \"person\")) private List\u003cDocument\u003e documents; } -------- @Data @Embeddable public class Document { private String cover; private String reference; } Map value All @Mapxxx annotations work on the key. Without the prefix, works on the value. E.g. @Column works for value, @MapKeyColumn works for key.\nA person can have many phone numbers. We can use map to store the value. Generally speaking, map increases the complexity of code, we can use other way to simplify the code without map.\nid name 1 John phone table\ntype number person home 2312 1 work 152 1 @Entity @Data public class Person { @Id private int id; private String name; @ElementCollection @CollectionTable(name = \"phone\", joinColumns = @JoinColumn(name = \"person\")) @MapKeyColumn(name = \"type\") // key @Column(name = \"number\") // value private Map\u003cString, String\u003e phoneNumbers; ] Use enum to map the key @MapKeyEnumerated for key @Enumerated for the value public class Person { @Id private int id; private String name; @ElementCollection @CollectionTable(name = \"phone\", joinColumns = @JoinColumn(name = \"person\")) @MapKeyColumn(name = \"type\") // key @Column(name = \"number\") // value @MapKeyEnumerated(EnumType.STRING) private Map\u003cPhoneType, String\u003e phoneNumbers; } ----------- public enum PhoneType { WORK, HOME } Inheritance, hierarchy of class @Inheritance - InheritanceType SINGLE_TABLE - default JOINED TABLE_PER_CLASS - rare use, not recommend These classes are based classes for demo:\n@Data @Entity @Inheritance(strategy = InheritanceType.xxxxxx) public class Person { @Id private int id; private String name; } ------------ @Data @Entity public class Artist extends Person { private String mastery; } ------------ @Entity @Data public class Worker extends Person { private int workHour; } ------main------ Person jack = new Person(); // set id 100 Artist duke = new Artist(); // set id 200 Worker roy = new Worker(); // set id 300 SINGLE_TABLE all classes in single table We annotated with this value on Person class\n@Inheritance(strategy = InheritanceType.SINGLE_TABLE) public class Person { @Id private int id; private String name; } Resulting in only one table in database:\nDTYPE id name mastery workHour Person 100 Jack null null Artist 200 Duke Drawing null Worker 300 Roy null 8 As shown above, there are columns set to null.\nJOINED - foreign key joined in 1 table Joined means the foreign key is joined in one table. This will actually generate 3 tables.\n@Data @Entity @Inheritance(strategy = InheritanceType.JOINED) public class Person { @Id private int id; private String name; } Person table\nid name 100 Jack 200 Duke 300 Roy Artist table\nid mastery 200 Drawing Worker table\nid workHour 300 30 Drawback: The disadvantage of this inheritance mapping method is that retrieving entities requires joins between tables. For high queries, it’s more likely to affect the performance.\nCustomize the foreign key column by @PrimaryKeyJoinColumn(name = \"\") Each table will share the same name id. If you want to make, for example, Artist table id another name:\n@Data @Entity @PrimaryKeyJoinColumn(name = \"artist_id\") public class Artist extends Person { // } This will set it name as artist_id\nArtist table\nartist_id mastery 200 Drawing TABLE_PER_CLASS - create table for each class with all the fields It maps each entity to its table, which contains all the properties of the entity, including the ones inherited.\n@Entity @Inheritance(strategy = InheritanceType.TABLE_PER_CLASS) public class Person { // } Person table\nid name 100 Jack Artist table\nid name mastery 200 Duke Drawing Worker table\nid name workHour 300 Roy 30 It’s no difference from creating an individual class without inheritance.\n@MappedSuperclass Create a template like class that works like an entity class. It can be used to remove duplicate code.\nThis class has no separated table in database. The mapping information can be override by @AttributeOverride @AssociationOverride.\n@Data @MappedSuperclass public abstract class Vehicle { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; private String color; } ---------- @Data @Entity public class Car extends Vehicle { private String gas; } ---------- @Data @Entity public class Bicycle extends Vehicle { private String model; } Car table\nid color gas 1 Blue Diesel Bicycle table\nid color model 1 Red BMAX This example put @id in abstract class. In practice, we should put it in the subclass instead. It’s because we can define the desired way of primary key strategy.\nEntityManager Get the EntityManager by EntityManagerFactory EntityManagerFactory factory = Persistence.createEntityManagerFactory(\"my-persistence-unit\"); EntityManager entityManager = factory.createEntityManager(); entityManager.begin(); // persist, flush, etc operations entityManager.commit(); entityManager.close(); Available EntityManager methods commit() - commit all changes from JPA context to database. When called, it’s where the SQL executed persist() flush() - to persist all data in database before commit() is called find() Product product = entityManager.find(Product.class, 10); // 10 is the primary key id getReference() The code is similar.\nProduct product = entityManager.getReference(Product.class, 10); But the main difference is if the object is not used later, the query will not be executed. The above code will not execute a SELECT query unless we use the object. e.g. print it in the console.\nThis actually use a proxy to check if the object is used.\ncontains() Check if the object is in the JPA context\nProduct product = entityManager.find(Product.class, 10); boolean isExist = entityManager.contains(product); remove() remove record in database\nProduct product = // get product entityManager.remove(product); // execute delete query ","wordCount":"3259","inLanguage":"en","datePublished":"2023-01-15T18:52:27Z","dateModified":"2023-01-15T18:52:27Z","author":{"@type":"Person","name":"Derry"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://derry.club/posts/java/jpa-cheat-sheet/"},"publisher":{"@type":"Organization","name":"Derry Dev Blog","logo":{"@type":"ImageObject","url":"https://github.com/derrykid/blogs-repo/blob/main/img/logo.png?raw=true"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://derry.club/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://derry.club/categories/ title=categories><span>categories</span></a></li><li><a href=https://derry.club/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://derry.club/>Home</a>&nbsp;»&nbsp;<a href=https://derry.club/posts/>Posts</a></div><h1 class=post-title>Jpa Cheat Sheet for annotations</h1><div class=post-meta><span title='2023-01-15 18:52:27 +0000 UTC'>January 15, 2023</span>&nbsp;·&nbsp;16 min&nbsp;·&nbsp;Derry&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/java/jpa-cheat-sheet.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#entity aria-label=Entity>Entity</a><ul><li><a href=#entity---marks-class-as-the-database-entity aria-label="@Entity - marks class as the database entity"><code>@Entity</code> - marks class as the database entity</a></li><li><a href=#table---table-name aria-label="@Table - table name"><code>@Table</code> - table name</a></li><li><a href=#id---mark-the-primary-key aria-label="@Id - mark the primary key"><code>@Id</code> - mark the primary key</a></li><li><a href=#generatedvalue---the-strategy-for-primary-key aria-label="@GeneratedValue - the strategy for primary key"><code>@GeneratedValue</code> - the strategy for primary key</a><ul><li><a href=#generationtypeidentity aria-label=GenerationType.IDENTITY><code>GenerationType.IDENTITY</code></a></li><li><a href=#generationtypesquence aria-label=GenerationType.SQUENCE><code>GenerationType.SQUENCE</code></a></li><li><a href=#generationtypetable aria-label=GenerationType.TABLE><code>GenerationType.TABLE</code></a><ul><li><a href=#customize-the-generator-by-tablegenerator aria-label="Customize the generator by @TableGenerator">Customize the generator by <code>@TableGenerator</code></a></li></ul></li><li><a href=#generator aria-label=Generator>Generator</a><ul><li><a href=#genericgenerator aria-label=@GenericGenerator><code>@GenericGenerator</code></a></li></ul></li></ul></li><li><a href=#column---name-in-database aria-label="@Column - name in database"><code>@Column</code> - name in database</a><ul><li><a href=#columnname--xxx---column-name aria-label="@Column(name = &amp;quot;xxx&amp;quot;) - column name"><code>@Column(name = "xxx")</code> - column name</a></li><li><a href=#columntable--xxx---table-name aria-label="@Column(table = &amp;quot;xxx&amp;quot;) - table name"><code>@Column(table = "xxx")</code> - table name</a></li></ul></li><li><a href=#enumerated---set-the-presentation-of-enum-value-in-database aria-label="@Enumerated - set the presentation of Enum value in database"><code>@Enumerated</code> - set the presentation of Enum value in database</a></li><li><a href=#temporal aria-label=@Temporal><code>@Temporal</code></a></li><li><a href=#embedded-embeddable---1-database-table-for-2-java-object aria-label="@Embedded, @Embeddable - 1 database table for 2 java object"><code>@Embedded</code>, <code>@Embeddable</code> - 1 database table for 2 java object</a><ul><li><a href=#if-the-column-name-doesnt-match-field-name---use-attributeoverride aria-label="If the column name doesn&amp;rsquo;t match field name - use @AttributeOverride">If the column name doesn&rsquo;t match field name - use <code>@AttributeOverride</code></a></li><li><a href=#associationoverride----need-attention aria-label="AssociationOverride &amp;ndash; need attention"><code>AssociationOverride</code> &ndash; need attention</a></li></ul></li><li><a href=#composite-primary-key---idclassclass aria-label="Composite primary key - @IdClass(class)">Composite primary key - <code>@IdClass(class)</code></a><ul><li><a href=#alternative-to-idclass-for-composite-primary-key-embeddedid aria-label="Alternative to @IdClass() for composite primary key: @EmbeddedId">Alternative to <code>@IdClass()</code> for composite primary key: <code>@EmbeddedId</code></a></li><li><a href=#create-a-third-class-and-annotate-with-embeddable-to-create-composite-key aria-label="Create a third class and annotate with @Embeddable to create composite key">Create a third class and annotate with <code>@Embeddable</code> to create composite key</a></li></ul></li><li><a href=#seldom-use---access-to-specify-access-the-field-or-by-getter aria-label="Seldom use - @Access to specify access the field or by getter">Seldom use - <code>@Access</code> to specify access the field or by getter</a></li><li><a href=#relationships aria-label=Relationships>Relationships</a><ul><li><a href=#joincolumn-to-config-the-default-foreign-key-name aria-label="@JoinColumn to config the default foreign key name"><code>@JoinColumn</code> to config the default foreign key name</a><ul><li><a href=#relationship-annotation-with-its-attribute-fields aria-label="Relationship annotation with its attribute fields">Relationship annotation with its attribute fields</a><ul><li><a href=#targetentity aria-label=targetEntity>targetEntity</a></li><li><a href=#cascade-attribute aria-label="cascade attribute">cascade attribute</a><ul><li><a href=#orphan-removal-vs-cascadetyperemove aria-label="Orphan removal vs CascadeType.REMOVE">Orphan removal vs <code>CascadeType.REMOVE</code></a></li></ul></li><li><a href=#fetch---fetch-all-related-info-or-not aria-label="fetch - fetch all related info or not"><code>fetch</code> - fetch all related info or not</a></li><li><a href=#mappedby aria-label=mappedBy>mappedBy</a></li><li><a href=#optional---default-true aria-label="optional - default true"><code>optional</code> - default <code>true</code></a></li></ul></li></ul></li><li><a href=#onetoone aria-label=OneToOne>OneToOne</a><ul><li><a href=#by-onetoone-unidirectional---only-use-this-annotation-at-one-class aria-label="By @OneToOne: unidirectional - only use this annotation at one class">By <code>@OneToOne</code>: unidirectional - only use this annotation at one class</a></li><li><a href=#onetoone---bidirectional---use-this-annotations-at-2-class aria-label="@OneToOne - bidirectional - use this annotations at 2 class"><code>@OneToOne</code> - bidirectional - use this annotations at 2 class</a></li><li><a href=#by-secondarytable-no-need-to-use-onetoone aria-label="By @SecondaryTable, no need to use @OneToOne">By <code>@SecondaryTable</code>, no need to use <code>@OneToOne</code></a></li></ul></li><li><a href=#onetomany aria-label=OneToMany>OneToMany</a><ul><li><a href=#create-the-third-table-named-after-other-tables-name aria-label="Create the third table named after other tables&amp;rsquo; name">Create the third table named after other tables&rsquo; name</a></li><li><a href=#dont-have-to-create-3rd-table aria-label="don&amp;rsquo;t have to create 3rd table">don&rsquo;t have to create 3rd table</a><ul><li><a href=#use-collectiont--to-store-a-collection-of-entities-bidirectional-example aria-label="Use Collection&amp;lt;T&amp;gt; to store a collection of entities, bidirectional example">Use <code>Collection&lt;T></code> to store a collection of entities, bidirectional example</a></li></ul></li></ul></li><li><a href=#manytomany---jointable aria-label="ManyToMany - @JoinTable">ManyToMany - <code>@JoinTable</code></a><ul><li><a href=#unidirectional---only-one-knows-the-other aria-label="unidirectional - only one knows the other">unidirectional - only one knows the other</a></li><li><a href=#bidirectional aria-label=bidirectional>bidirectional</a></li></ul></li><li><a href=#elementcollection---mark-a-non-entity-object aria-label="@ElementCollection - mark a non-entity object"><code>@ElementCollection</code> - mark a non-entity object</a><ul><li><a href=#map-a-non-entity-class aria-label="map a non-entity class">map a non-entity class</a></li><li><a href=#map-embeddable aria-label="map @Embeddable">map <code>@Embeddable</code></a></li></ul></li></ul></li><li><a href=#map-value aria-label="Map value">Map value</a><ul><li><a href=#use-enum-to-map-the-key aria-label="Use enum to map the key">Use enum to map the key</a></li></ul></li><li><a href=#inheritance-hierarchy-of-class aria-label="Inheritance, hierarchy of class">Inheritance, hierarchy of class</a><ul><li><a href=#inheritance---inheritancetype aria-label="@Inheritance - InheritanceType"><code>@Inheritance</code> - InheritanceType</a><ul><li><a href=#single_table-all-classes-in-single-table aria-label="SINGLE_TABLE all classes in single table"><code>SINGLE_TABLE</code> all classes in single table</a></li><li><a href=#joined---foreign-key-joined-in-1-table aria-label="JOINED - foreign key joined in 1 table"><code>JOINED</code> - foreign key joined in 1 table</a><ul><li><a href=#customize-the-foreign-key-column-by-primarykeyjoincolumnname-- aria-label="Customize the foreign key column by @PrimaryKeyJoinColumn(name = &amp;quot;&amp;quot;)">Customize the foreign key column by <code>@PrimaryKeyJoinColumn(name = "")</code></a></li></ul></li><li><a href=#table_per_class---create-table-for-each-class-with-all-the-fields aria-label="TABLE_PER_CLASS - create table for each class with all the fields"><code>TABLE_PER_CLASS</code> - create table for each class with all the fields</a></li></ul></li><li><a href=#mappedsuperclass aria-label=@MappedSuperclass><code>@MappedSuperclass</code></a></li></ul></li></ul></li><li><a href=#entitymanager aria-label=EntityManager>EntityManager</a><ul><li><a href=#get-the-entitymanager-by-entitymanagerfactory aria-label="Get the EntityManager by EntityManagerFactory">Get the <code>EntityManager</code> by <code>EntityManagerFactory</code></a></li><li><a href=#available-entitymanager-methods aria-label="Available EntityManager methods">Available <code>EntityManager</code> methods</a><ul><li><a href=#find aria-label=find()><code>find()</code></a></li><li><a href=#getreference aria-label=getReference()><code>getReference()</code></a></li><li><a href=#contains aria-label=contains()><code>contains()</code></a></li><li><a href=#remove aria-label=remove()><code>remove()</code></a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><h1 id=entity>Entity<a hidden class=anchor aria-hidden=true href=#entity>#</a></h1><h2 id=entity---marks-class-as-the-database-entity><code>@Entity</code> - marks class as the database entity<a hidden class=anchor aria-hidden=true href=#entity---marks-class-as-the-database-entity>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Pokemon</span><span class=o>{}</span>
</span></span></code></pre></div><h2 id=table---table-name><code>@Table</code> - table name<a hidden class=anchor aria-hidden=true href=#table---table-name>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Table</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;Poke&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Pokemon</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=id---mark-the-primary-key><code>@Id</code> - mark the primary key<a hidden class=anchor aria-hidden=true href=#id---mark-the-primary-key>#</a></h2><p>Annotate primary key</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Id</span>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span></code></pre></div><h2 id=generatedvalue---the-strategy-for-primary-key><code>@GeneratedValue</code> - the strategy for primary key<a hidden class=anchor aria-hidden=true href=#generatedvalue---the-strategy-for-primary-key>#</a></h2><p><a href=https://medium.com/@BalicantaYao/jpa-%E4%B8%AD-generatedvalue-%E7%9A%84%E4%B8%89%E7%A8%AE%E7%AD%96%E7%95%A5-bedebf1c076d>GenerationType</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Id</span>
</span></span><span class=line><span class=cl><span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span></code></pre></div><h3 id=generationtypeidentity><code>GenerationType.IDENTITY</code><a hidden class=anchor aria-hidden=true href=#generationtypeidentity>#</a></h3><p>The database is set AUTO_INCREMENT.</p><p>Similar to SQL <code>id NOT NULL AUTO_INCREMENT</code></p><h3 id=generationtypesquence><code>GenerationType.SQUENCE</code><a hidden class=anchor aria-hidden=true href=#generationtypesquence>#</a></h3><h3 id=generationtypetable><code>GenerationType.TABLE</code><a hidden class=anchor aria-hidden=true href=#generationtypetable>#</a></h3><p>Use the TABLE in database to set the primary key for us, instead of the DBMS system.</p><p>In database, I&rsquo;ve created a table named <code>key_generator</code>. There are 2 columns in it:</p><table><thead><tr><th>key_name</th><th>next_val</th></tr></thead><tbody><tr><td>//</td><td>//</td></tr></tbody></table><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Id</span>
</span></span><span class=line><span class=cl><span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>TABLE</span><span class=o>,</span> <span class=n>generator</span> <span class=o>=</span> <span class=s>&#34;key_generator&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span></code></pre></div><p><strong>The default column name of the <code>value</code> is <code>next_val</code></strong>.</p><h4 id=customize-the-generator-by-tablegenerator>Customize the generator by <code>@TableGenerator</code><a hidden class=anchor aria-hidden=true href=#customize-the-generator-by-tablegenerator>#</a></h4><p>To achieve this table:
<strong>key_generator</strong></p><table><thead><tr><th>key_name</th><th>key_value</th></tr></thead><tbody><tr><td>product_sequence</td><td>150</td></tr></tbody></table><p>We have to use the <code>@TableGenerator</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Id</span>
</span></span><span class=line><span class=cl><span class=nd>@TableGenerator</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;key_generator&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>table</span> <span class=o>=</span> <span class=s>&#34;key_generator&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>pkColumnName</span> <span class=o>=</span> <span class=s>&#34;key_name&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>pkColumnValue</span> <span class=o>=</span> <span class=s>&#34;product_sequence&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>valueColumnName</span> <span class=o>=</span> <span class=s>&#34;key_value&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>allocationSize</span> <span class=o>=</span> <span class=mi>20</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>TABLE</span><span class=o>,</span> <span class=n>generator</span> <span class=o>=</span> <span class=s>&#34;key_generator&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span></code></pre></div><h3 id=generator>Generator<a hidden class=anchor aria-hidden=true href=#generator>#</a></h3><p>For primary key, we can use a custom generator like <code>@GenericGenerator</code> provided by hibernate.</p><h4 id=genericgenerator><code>@GenericGenerator</code><a hidden class=anchor aria-hidden=true href=#genericgenerator>#</a></h4><p>There are several generators available. This one is an example.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Id</span>
</span></span><span class=line><span class=cl><span class=nd>@GenericGenerator</span><span class=o>(</span> 
</span></span><span class=line><span class=cl>                <span class=n>name</span> <span class=o>=</span> <span class=s>&#34;uuid&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                <span class=n>strategy</span> <span class=o>=</span> <span class=s>&#34;org.hibernate.id.UUIDHEXGenerator&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                <span class=n>parameters</span> <span class=o>=</span> <span class=nd>@Parameter</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;separator&#34;</span><span class=o>,</span> <span class=n>value</span> <span class=o>=</span> <span class=s>&#34;-&#34;</span><span class=o>)</span> <span class=c1>// this is optional
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>generator</span> <span class=o>=</span> <span class=s>&#34;uuid&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=n>String</span> <span class=n>id</span><span class=o>;</span>
</span></span></code></pre></div><h2 id=column---name-in-database><code>@Column</code> - name in database<a hidden class=anchor aria-hidden=true href=#column---name-in-database>#</a></h2><h3 id=columnname--xxx---column-name><code>@Column(name = "xxx")</code> - column name<a hidden class=anchor aria-hidden=true href=#columnname--xxx---column-name>#</a></h3><p>It&rsquo;s used to relate the name in database.</p><p>For example, when we create a database in app:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Pokemon</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;Special-Attack&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>specialAttack</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>This will set the name of column in database for &ldquo;Special-Attack&rdquo;, if not set, it will set as the field name;</p><h3 id=columntable--xxx---table-name><code>@Column(table = "xxx")</code> - table name<a hidden class=anchor aria-hidden=true href=#columntable--xxx---table-name>#</a></h3><p>It can be used at when work with relationships.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Table</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;Company&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@SecondaryTable</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;address&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>pkJoinColumns</span> <span class=o>=</span> <span class=nd>@PrimaryKeyJoinColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;company_fk&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Company</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=o>(</span><span class=n>table</span> <span class=o>=</span> <span class=s>&#34;address&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>street</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=o>(</span><span class=n>table</span> <span class=o>=</span> <span class=s>&#34;address&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>road</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=enumerated---set-the-presentation-of-enum-value-in-database><code>@Enumerated</code> - set the presentation of Enum value in database<a hidden class=anchor aria-hidden=true href=#enumerated---set-the-presentation-of-enum-value-in-database>#</a></h2><p>At field, we might use enum to set the field. Use the <code>@Enumerated</code> annotation</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Price</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>double</span> <span class=n>amount</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Enumerated</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=n>EnumType</span><span class=o>.</span><span class=na>ORDINAL</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Currency</span> <span class=n>currency</span><span class=o>;</span>              <span class=c1>// enum type
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>Currency</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>EUR</span><span class=o>,</span> <span class=n>USD</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p><code>@Enumerated</code> default sets to ordinal value, however there is alternative:</p><ul><li><code>@Enumerated(EnumType.ORDINAL)</code> - default</li><li><code>@Enumerated(EnumType.STRING)</code></li></ul><p>Different setting to changes the database table:</p><table><thead><tr><th>id: int</th><th>amount:double</th><th>currency: (int or varchar)</th></tr></thead><tbody><tr><td>1</td><td>10</td><td>0 (EUR, if set ordinal)</td></tr><tr><td>2</td><td>30</td><td>USD(set String)</td></tr></tbody></table><h2 id=temporal><code>@Temporal</code><a hidden class=anchor aria-hidden=true href=#temporal>#</a></h2><p>For saving the time, JPA has implemented automatically, so we don&rsquo;t have to use this <code>@Temporal</code> annotation unless we use the legacy package <code>Data.class</code>.</p><p>We can just use this, the implementation will help us persist the data:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Event</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;event_time&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>LocalDate</span> <span class=n>eventTime</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// or ZonedDateTime;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>In database:</p><table><thead><tr><th>id</th><th>event_time: DATE</th></tr></thead><tbody><tr><td>1</td><td>2020-12-22</td></tr></tbody></table><p>We can also use timestamp to store the data. <strong>Note that whichever you choose, ZonedDateTime or LocalDateTime, the data saved in database is the same.</strong></p><h2 id=embedded-embeddable---1-database-table-for-2-java-object><code>@Embedded</code>, <code>@Embeddable</code> - 1 database table for 2 java object<a hidden class=anchor aria-hidden=true href=#embedded-embeddable---1-database-table-for-2-java-object>#</a></h2><p>We can use this to persist an object in our entity. For example we have a company table like this:</p><table><thead><tr><th>id</th><th>name</th><th>no.</th><th>street</th><th>city</th></tr></thead><tbody><tr><td>1</td><td>Water Corp.</td><td>12</td><td>Oak street</td><td>London</td></tr></tbody></table><p>We saved the address separately. On the other hand, for OOP point of view, we should save it as an object like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Company</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@Embedded</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Address</span> <span class=n>address</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Embeddable</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Address</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>number</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>street</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>city</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>This way, when we create an instance of <code>company</code>, we can persist it and commit in database in OOP way.</p><h3 id=if-the-column-name-doesnt-match-field-name---use-attributeoverride>If the column name doesn&rsquo;t match field name - use <code>@AttributeOverride</code><a hidden class=anchor aria-hidden=true href=#if-the-column-name-doesnt-match-field-name---use-attributeoverride>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Embeddable</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Address</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>no</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>strt</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>city</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>For this, the database can&rsquo;t match the field name. We have to use <code>@AttributeOverride</code> in company class to specify the change:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>company</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// fields
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nd>@Embedded</span>
</span></span><span class=line><span class=cl>    <span class=nd>@AttributeOverride</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;no&#34;</span><span class=o>,</span> <span class=n>column</span> <span class=o>=</span> <span class=nd>@Column</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;number&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=nd>@AttributeOverride</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;strt&#34;</span><span class=o>,</span> <span class=n>column</span> <span class=o>=</span> <span class=nd>@Column</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;street&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Address</span> <span class=n>address</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Or use the <code>@AttributeOverrides</code> to group these:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@AttributeOverrides</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@AttributeOverride</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;no&#34;</span><span class=o>,</span> <span class=n>column</span> <span class=o>=</span> <span class=nd>@Column</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;number&#34;</span><span class=o>)),</span>
</span></span><span class=line><span class=cl>    <span class=nd>@AttributeOverride</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;strt&#34;</span><span class=o>,</span> <span class=n>column</span> <span class=o>=</span> <span class=nd>@Column</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;street&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=n>Address</span> <span class=n>address</span><span class=o>;</span>
</span></span></code></pre></div><h3 id=associationoverride----need-attention><code>AssociationOverride</code> &ndash; need attention<a hidden class=anchor aria-hidden=true href=#associationoverride----need-attention>#</a></h3><p>For rare cases, this can used to substitute <code>@AttributeOverride</code>. But this increase the complexity.</p><h2 id=composite-primary-key---idclassclass>Composite primary key - <code>@IdClass(class)</code><a hidden class=anchor aria-hidden=true href=#composite-primary-key---idclassclass>#</a></h2><p>Composite key is that there is 2 primary key in the table:</p><p><em>Department table</em></p><table><thead><tr><th>code:pk</th><th>id:pk</th><th>name</th></tr></thead><tbody><tr><td>C132</td><td>S23</td><td>a</td></tr><tr><td>C132</td><td>S24</td><td>b</td></tr></tbody></table><p>We have to create 2 classes to implement this: <strong>note the <code>@IdClass()</code>, and 2 <code>@Id</code> on the fields.</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@IdClass</span><span class=o>(</span><span class=n>DepartmentPK</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@Table</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;department&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Department</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>code</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// composite key class
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DepartmentPK</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>code</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Probably the <code>implements Serializable</code> is not mandatory anymore, cuz when I remove it, the code still works.</p><h3 id=alternative-to-idclass-for-composite-primary-key-embeddedid>Alternative to <code>@IdClass()</code> for composite primary key: <code>@EmbeddedId</code><a hidden class=anchor aria-hidden=true href=#alternative-to-idclass-for-composite-primary-key-embeddedid>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Building</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@EmbeddedId</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>BuildingPK</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// more fileds
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Embeddable</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BuildingPK</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>number</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>code</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=create-a-third-class-and-annotate-with-embeddable-to-create-composite-key>Create a third class and annotate with <code>@Embeddable</code> to create composite key<a hidden class=anchor aria-hidden=true href=#create-a-third-class-and-annotate-with-embeddable-to-create-composite-key>#</a></h3><p>Student table</p><table><thead><tr><th>student_id</th><th>name</th><th>grade</th></tr></thead><tbody><tr><td>1</td><td>John</td><td>1</td></tr></tbody></table><p>Subject table</p><table><thead><tr><th>subject_id</th><th>name</th></tr></thead><tbody><tr><td>101</td><td>English</td></tr></tbody></table><p>marks table</p><table><thead><tr><th>subject_id</th><th>student_id</th><th>mark</th></tr></thead><tbody><tr><td>101</td><td>1</td><td>75</td></tr></tbody></table><p>The marks table have a composite key made of <code>subject_id</code> and <code>student_id</code>.</p><p>We can create a third class to do it</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Student</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;student_id&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Long</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// fields
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---------</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Subject</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;subject_id&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Long</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// fields
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>----------</span>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Table</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;student_marks&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>StudentMark</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@EmbeddedId</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>StudentMarkId</span> <span class=n>markId</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>mark</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-----------</span>
</span></span><span class=line><span class=cl><span class=nd>@Embeddable</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>StudentMarkId</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@ManyToOne</span><span class=o>(</span><span class=n>cascade</span> <span class=o>=</span> <span class=n>CascadeType</span><span class=o>.</span><span class=na>ALL</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JoinColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;student_id&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Student</span> <span class=n>student</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@ManyToOne</span><span class=o>(</span><span class=n>cascade</span> <span class=o>=</span> <span class=n>CascadeType</span><span class=o>.</span><span class=na>ALL</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JoinColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;subject_id&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Subject</span> <span class=n>subject</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Note that <code>StudentMarkId</code> is a <code>@Embeddable</code>. It works as an composite key. To save it to repository, we have to do an interface as well:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>StudentMarkRepository</span> <span class=kd>extends</span> <span class=n>JpaRepository</span><span class=o>&lt;</span><span class=n>StudentMark</span><span class=o>,</span> <span class=n>StudentMarkId</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p><strong>The JpaRepository&lt;T, ID></strong> ID field is the embedded id.</p><p>This is how client calls it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl>    <span class=nd>@Bean</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>CommandLineRunner</span> <span class=nf>run</span><span class=o>(</span><span class=n>StudentRepository</span> <span class=n>studentRepository</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                                 <span class=n>SubjectRepository</span> <span class=n>subjectRepository</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                                 <span class=n>StudentMarkRepository</span> <span class=n>studentMarkRepository</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>args</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>Student</span> <span class=n>jack</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Student</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>jack</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;jack&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>jack</span><span class=o>.</span><span class=na>setGrade</span><span class=o>(</span><span class=mi>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>studentRepository</span><span class=o>.</span><span class=na>save</span><span class=o>(</span><span class=n>jack</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>Subject</span> <span class=n>english</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Subject</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>english</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;English&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>subjectRepository</span><span class=o>.</span><span class=na>save</span><span class=o>(</span><span class=n>english</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>StudentMarkId</span> <span class=n>id</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StudentMarkId</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>id</span><span class=o>.</span><span class=na>setStudent</span><span class=o>(</span><span class=n>jack</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>id</span><span class=o>.</span><span class=na>setSubject</span><span class=o>(</span><span class=n>english</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>StudentMark</span> <span class=n>mark</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StudentMark</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>mark</span><span class=o>.</span><span class=na>setMark</span><span class=o>(</span><span class=mi>75</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>mark</span><span class=o>.</span><span class=na>setMarkId</span><span class=o>(</span><span class=n>id</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>studentMarkRepository</span><span class=o>.</span><span class=na>save</span><span class=o>(</span><span class=n>mark</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>};</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></div><h2 id=seldom-use---access-to-specify-access-the-field-or-by-getter>Seldom use - <code>@Access</code> to specify access the field or by getter<a hidden class=anchor aria-hidden=true href=#seldom-use---access-to-specify-access-the-field-or-by-getter>#</a></h2><p>Default is by field: <code>@Access(AccessType.FIELD)</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Access</span><span class=o>(</span><span class=n>AccessType</span><span class=o>.</span><span class=na>PROPERTY</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>getId</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=relationships>Relationships<a hidden class=anchor aria-hidden=true href=#relationships>#</a></h2><h3 id=joincolumn-to-config-the-default-foreign-key-name><code>@JoinColumn</code> to config the default foreign key name<a hidden class=anchor aria-hidden=true href=#joincolumn-to-config-the-default-foreign-key-name>#</a></h3><p>By default, the foreign key naming is <code>product_id</code>, in form of <code>table_id</code>.</p><p>You can change that by:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JoinColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;product_fk&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@OneToOne</span>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=n>Product</span> <span class=n>product</span><span class=o>;</span>
</span></span></code></pre></div><h4 id=relationship-annotation-with-its-attribute-fields>Relationship annotation with its attribute fields<a hidden class=anchor aria-hidden=true href=#relationship-annotation-with-its-attribute-fields>#</a></h4><p>Relationship annotations</p><ul><li><code>@OneToOne</code></li><li><code>@OneToMany</code></li><li><code>@ManyToOne</code></li><li><code>@ManyToMany</code></li></ul><h5 id=targetentity>targetEntity<a hidden class=anchor aria-hidden=true href=#targetentity>#</a></h5><p>This is used to specify the target class, and works with polymorphism.</p><p>This example <code>Object</code> is set as field type, but it&rsquo;s too vague, we want a more specific class.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@OneToMany</span><span class=o>(</span><span class=n>targetEntity</span> <span class=o>=</span> <span class=n>className</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=n>Object</span> <span class=n>field</span><span class=o>;</span>
</span></span></code></pre></div><h5 id=cascade-attribute>cascade attribute<a hidden class=anchor aria-hidden=true href=#cascade-attribute>#</a></h5><p>It&rsquo;s often that when we persist one object in database, it&rsquo;s associated with another object.</p><p>The trainer has a pokemon <code>pikachu</code>, to persist <code>trainer</code> we also have to persist <code>pikachu</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>pokeMonRepository</span><span class=o>.</span><span class=na>save</span><span class=o>(</span><span class=n>pikachu</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>trainerRepository</span><span class=o>.</span><span class=na>save</span><span class=o>(</span><span class=n>trainer</span><span class=o>);</span>
</span></span></code></pre></div><p><strong><code>Cascade</code> is the way to specify the behaviour of this.</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Trainer</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@OneToOne</span><span class=o>(</span><span class=n>cascade</span> <span class=o>=</span> <span class=n>CascadeType</span><span class=o>.</span><span class=na>ALL</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Pokemon</span> <span class=n>pokemon</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Pokemon</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><ul><li><code>PERSIST</code> - The operations cascade to related entities. If only save <code>trainer</code>, <code>pikachu</code> is also saved</li><li><code>REMOVE</code> - Similar to <code>PERSIST</code> but this is delete. If remove the <code>trainer</code>, the <code>pikachu</code> is also removed!</li><li><code>REFRESH</code> - is to refresh the data in the object. Perhaps there was a change on the database which needs to be synced.</li><li><code>MERGE</code> - propagate the operation from one to another. If <code>pikachu</code> changes its data, the trainer whose hold it as the instance variable will also flush the value. It&rsquo;s not in database layer.</li><li><code>ALL</code> - all of above. Set to all isn&rsquo;t always making the program run well. See: <a href=https://www.baeldung.com/hibernate-detached-entity-passed-to-persist>detached entity exception</a></li></ul><p>There are more types to select from.</p><h6 id=orphan-removal-vs-cascadetyperemove>Orphan removal vs <code>CascadeType.REMOVE</code><a hidden class=anchor aria-hidden=true href=#orphan-removal-vs-cascadetyperemove>#</a></h6><p>While <code>REMOVE</code> remove all related entities. The <code>orphanRemoval</code> provides a smart way to remove a record based on relationship.</p><p>A trainer can take 6 pokemon on journey. We call it <em>partyPokemons</em> here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Trainer</span> <span class=n>trainer</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findById</span><span class=o>(</span><span class=n>Trainer</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=mi>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Set</span><span class=o>&lt;</span><span class=n>Pokemon</span><span class=o>&gt;</span> <span class=n>partyPokemons</span> <span class=o>=</span> <span class=n>trainer</span><span class=o>.</span><span class=na>getPartyPokemon</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>partyPokemons</span><span class=o>.</span><span class=na>remove</span><span class=o>(</span><span class=n>xxx</span><span class=o>);</span>    <span class=c1>// we remove one pokemon, in collection
</span></span></span></code></pre></div><p>Now that in the party, trainer have 5 pokemon, and remove 1 from the collection. That removed one is an orphan. That orphan entity will be removed from the database, even though we did not use any delete operation.</p><h5 id=fetch---fetch-all-related-info-or-not><code>fetch</code> - fetch all related info or not<a hidden class=anchor aria-hidden=true href=#fetch---fetch-all-related-info-or-not>#</a></h5><ul><li><code>FetchType.EAGER</code> - fetch all info of the object fields, includes other table</li><li><code>FetchType.LAZY</code> - fetch the info only when we need it.
Better specify the value, cuz the default depends on the annotations</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@OneToOne</span><span class=o>(</span> <span class=n>fetch</span> <span class=o>=</span> <span class=n>FetchType</span><span class=o>.</span><span class=na>EAGER</span> <span class=o>)</span>
</span></span></code></pre></div><h5 id=mappedby>mappedBy<a hidden class=anchor aria-hidden=true href=#mappedby>#</a></h5><p>To specify the bidirectional model. It&rsquo;s used at the <strong>owned side.</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@OneToMany</span><span class=o>(</span><span class=n>mappedBy</span> <span class=o>=</span> <span class=s>&#34;fieldNameInAnotherClass&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=n>Document</span> <span class=n>doc</span><span class=o>;</span>
</span></span></code></pre></div><h5 id=optional---default-true><code>optional</code> - default <code>true</code><a hidden class=anchor aria-hidden=true href=#optional---default-true>#</a></h5><p>By default, this allows us to make one field optional. Like in Detail field <code>product</code>, we set product, but the <code>product</code> detail can be null.</p><p>If you want to make sure it always have value:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@OneToOne</span><span class=o>(</span><span class=n>optional</span> <span class=o>=</span> <span class=kc>false</span><span class=o>)</span>
</span></span></code></pre></div><h3 id=onetoone>OneToOne<a hidden class=anchor aria-hidden=true href=#onetoone>#</a></h3><h4 id=by-onetoone-unidirectional---only-use-this-annotation-at-one-class>By <code>@OneToOne</code>: unidirectional - only use this annotation at one class<a hidden class=anchor aria-hidden=true href=#by-onetoone-unidirectional---only-use-this-annotation-at-one-class>#</a></h4><p>Unidirectional: in this case, only <code>Detail</code> knows the product object.</p><p>Product table</p><table><thead><tr><th>id</th><th>name</th><th>price</th></tr></thead><tbody><tr><td>1</td><td>beer</td><td>10</td></tr></tbody></table><p>Detail table, the foreign key must named this way <code>product_id</code>. If want to config this, see <code>@JoinColumn</code></p><table><thead><tr><th>id</th><th>kcal</th><th>product_id</th></tr></thead><tbody><tr><td>101</td><td>200</td><td>1</td></tr></tbody></table><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Product</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>double</span> <span class=n>price</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Detail</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>kcal</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@OneToOne</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Product</span> <span class=n>product</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h4 id=onetoone---bidirectional---use-this-annotations-at-2-class><code>@OneToOne</code> - bidirectional - use this annotations at 2 class<a hidden class=anchor aria-hidden=true href=#onetoone---bidirectional---use-this-annotations-at-2-class>#</a></h4><blockquote><p>Not all cases need bidirectional, it will have overheads as well. Think if you really need it.</p></blockquote><p>If you want to map it bidirectional:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Detail</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// some fileds
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@OneToOne</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Product</span> <span class=n>productField</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>product</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// some fields
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@OneToOne</span><span class=o>(</span><span class=n>mappedBy</span> <span class=o>=</span> <span class=s>&#34;productField&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Detail</span> <span class=n>detail</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>In this case, <code>Detail</code> class is considered <strong>the owner of the relationship.</strong> So the other side <code>product</code> must use <code>mappedBy</code> value.</p><h4 id=by-secondarytable-no-need-to-use-onetoone>By <code>@SecondaryTable</code>, no need to use <code>@OneToOne</code><a hidden class=anchor aria-hidden=true href=#by-secondarytable-no-need-to-use-onetoone>#</a></h4><p>Table company</p><table><thead><tr><th>id</th><th>name</th></tr></thead><tbody><tr><td>5</td><td>A Corp</td></tr></tbody></table><p>Table address</p><table><thead><tr><th>id</th><th>road</th><th>street</th><th>company_fk</th></tr></thead><tbody><tr><td>1</td><td>Oak</td><td>Sky street</td><td>5</td></tr></tbody></table><p>In table <code>address</code>, there&rsquo;s a foreign key <code>company_fk</code>. It actually is the constrain key with table <code>company</code>.</p><p>We can use a class to achieve this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Table</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;Company&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@SecondaryTable</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;address&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>pkJoinColumns</span> <span class=o>=</span> <span class=nd>@PrimaryKeyJoinColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;company_fk&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Company</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=o>(</span><span class=n>table</span> <span class=o>=</span> <span class=s>&#34;address&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>street</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=o>(</span><span class=n>table</span> <span class=o>=</span> <span class=s>&#34;address&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>road</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>There is an annotation <code>SecondaryTable</code> on top of the class, specify the name of SecondaryTable. Besides, it points out the <code>foreign key: company_fk</code>.</p><p>In the field, it also specifies <code>@Column(table = "address")</code>.</p><h3 id=onetomany>OneToMany<a hidden class=anchor aria-hidden=true href=#onetomany>#</a></h3><h4 id=create-the-third-table-named-after-other-tables-name>Create the third table named after other tables&rsquo; name<a hidden class=anchor aria-hidden=true href=#create-the-third-table-named-after-other-tables-name>#</a></h4><p>A department can have many employees. An employee belongs to one department.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Table</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;department&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Department</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@OneToMany</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Employee</span><span class=o>&gt;</span> <span class=n>employee</span><span class=o>;</span>  <span class=c1>// this must match the name
</span></span></span><span class=line><span class=cl><span class=c1></span>                                      <span class=c1>// of column in department_employee
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---------------------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Table</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;employee&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Employee</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>For this to work, <strong>we have to create the 3rd table <code>department_employee</code>.</strong></p><p>Table <code>department_employee</code></p><table><thead><tr><th>department_id</th><th>employee_id</th></tr></thead><tbody><tr><td>//</td><td>//</td></tr></tbody></table><h4 id=dont-have-to-create-3rd-table>don&rsquo;t have to create 3rd table<a hidden class=anchor aria-hidden=true href=#dont-have-to-create-3rd-table>#</a></h4><p>One person can have many documents</p><p>Document table:</p><table><thead><tr><th>id</th><th>person_id</th></tr></thead><tbody><tr><td>1</td><td>1</td></tr><tr><td>2</td><td>1</td></tr></tbody></table><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>--------------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Document</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@ManyToOne</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Person</span> <span class=n>person</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h5 id=use-collectiont--to-store-a-collection-of-entities-bidirectional-example>Use <code>Collection&lt;T></code> to store a collection of entities, bidirectional example<a hidden class=anchor aria-hidden=true href=#use-collectiont--to-store-a-collection-of-entities-bidirectional-example>#</a></h5><p>Take the Person class for example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@OneToMany</span><span class=o>(</span><span class=n>mappedBy</span> <span class=o>=</span> <span class=s>&#34;person&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Collection</span><span class=o>&lt;</span><span class=n>Document</span><span class=o>&gt;</span> <span class=n>documents</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>This can save multiple documents at a time</p><h3 id=manytomany---jointable>ManyToMany - <code>@JoinTable</code><a hidden class=anchor aria-hidden=true href=#manytomany---jointable>#</a></h3><h4 id=unidirectional---only-one-knows-the-other>unidirectional - only one knows the other<a hidden class=anchor aria-hidden=true href=#unidirectional---only-one-knows-the-other>#</a></h4><p>One professor may have multiple students, and one student may have multiple professors.</p><ul><li>Professor table: id, name</li><li>Student table: id, name</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Professor</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@ManyToMany</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JoinTable</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;professor_student&#34;</span><span class=o>,</span>  <span class=c1>// table name, this value here is the default value
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>joinColumns</span> <span class=o>=</span> <span class=nd>@JoinColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;professor&#34;</span><span class=o>),</span>      <span class=c1>// column name, suppose to be professor_id
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>inverseJoinColumns</span> <span class=o>=</span> <span class=nd>@JoinColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;student&#34;</span><span class=o>)</span>  <span class=c1>// the other column name
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Student</span><span class=o>&gt;</span> <span class=n>students</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>------------------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Student</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h4 id=bidirectional>bidirectional<a hidden class=anchor aria-hidden=true href=#bidirectional>#</a></h4><p>Annotated student class</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Student</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@ManyToMany</span><span class=o>(</span><span class=n>mappedBy</span> <span class=o>=</span> <span class=s>&#34;students&#34;</span><span class=o>)</span>      <span class=c1>// the field name in the Professor class
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>private</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Professor</span><span class=o>&gt;</span> <span class=n>professors</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=elementcollection---mark-a-non-entity-object><code>@ElementCollection</code> - mark a non-entity object<a hidden class=anchor aria-hidden=true href=#elementcollection---mark-a-non-entity-object>#</a></h3><p>It&rsquo;s used to mark something that wasn&rsquo;t created as entity.
For example, we have a <code>person</code> table, and a <code>phone</code> table</p><h4 id=map-a-non-entity-class>map a non-entity class<a hidden class=anchor aria-hidden=true href=#map-a-non-entity-class>#</a></h4><p>Person</p><table><thead><tr><th>id</th><th>name</th></tr></thead><tbody><tr><td>1</td><td>John</td></tr></tbody></table><p>phone</p><table><thead><tr><th>number</th><th>person</th></tr></thead><tbody><tr><td>312</td><td>1</td></tr></tbody></table><p>We did not create a entity class <code>phone</code>, we save it as a String in a list.</p><p>The <code>@ElementCollection</code> is in used here to mark a non-entity class.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@ElementCollection</span>
</span></span><span class=line><span class=cl>    <span class=nd>@CollectionTable</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;phone&#34;</span><span class=o>,</span> <span class=n>joinColumns</span> <span class=o>=</span> <span class=nd>@JoinColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;person&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;number&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>phoneNumbers</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h4 id=map-embeddable>map <code>@Embeddable</code><a hidden class=anchor aria-hidden=true href=#map-embeddable>#</a></h4><p>It can also to map an <code>Embeddable</code> class</p><p>Document table:</p><table><thead><tr><th>cover</th><th>reference</th><th>person</th></tr></thead><tbody><tr><td>&mdash;&mdash;-</td><td>&mdash;&mdash;&mdash;&ndash;</td><td>&mdash;&mdash;&ndash;</td></tr></tbody></table><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// other fields
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nd>@ElementCollection</span>
</span></span><span class=line><span class=cl>    <span class=nd>@CollectionTable</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;document&#34;</span><span class=o>,</span> <span class=n>joinColumns</span> <span class=o>=</span> <span class=nd>@JoinColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;person&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Document</span><span class=o>&gt;</span> <span class=n>documents</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>--------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Embeddable</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Document</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>cover</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>reference</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=map-value>Map value<a hidden class=anchor aria-hidden=true href=#map-value>#</a></h2><p>All <code>@Mapxxx</code> annotations work on the key. Without the prefix, works on the value. E.g. <code>@Column</code> works for value, <code>@MapKeyColumn</code> works for key.</p><p>A person can have many phone numbers. We can use map to store the value. <strong>Generally speaking, map increases the complexity of code, we can use other way to simplify the code without map.</strong></p><table><thead><tr><th>id</th><th>name</th></tr></thead><tbody><tr><td>1</td><td>John</td></tr></tbody></table><p><code>phone</code> table</p><table><thead><tr><th>type</th><th>number</th><th>person</th></tr></thead><tbody><tr><td>home</td><td>2312</td><td>1</td></tr><tr><td>work</td><td>152</td><td>1</td></tr></tbody></table><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@ElementCollection</span>
</span></span><span class=line><span class=cl>    <span class=nd>@CollectionTable</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;phone&#34;</span><span class=o>,</span> <span class=n>joinColumns</span> <span class=o>=</span> <span class=nd>@JoinColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;person&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=nd>@MapKeyColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;type&#34;</span><span class=o>)</span>    <span class=c1>// key
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@Column</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;number&#34;</span><span class=o>)</span>        <span class=c1>// value
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>private</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=n>phoneNumbers</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>]</span>
</span></span></code></pre></div><h3 id=use-enum-to-map-the-key>Use enum to map the key<a hidden class=anchor aria-hidden=true href=#use-enum-to-map-the-key>#</a></h3><ul><li><code>@MapKeyEnumerated</code> for key</li><li><code>@Enumerated</code> for the value</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@ElementCollection</span>
</span></span><span class=line><span class=cl>    <span class=nd>@CollectionTable</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;phone&#34;</span><span class=o>,</span> <span class=n>joinColumns</span> <span class=o>=</span> <span class=nd>@JoinColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;person&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=nd>@MapKeyColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;type&#34;</span><span class=o>)</span>    <span class=c1>// key
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@Column</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;number&#34;</span><span class=o>)</span>        <span class=c1>// value
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@MapKeyEnumerated</span><span class=o>(</span><span class=n>EnumType</span><span class=o>.</span><span class=na>STRING</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>PhoneType</span><span class=o>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=n>phoneNumbers</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-----------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>PhoneType</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>WORK</span><span class=o>,</span> <span class=n>HOME</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=inheritance-hierarchy-of-class>Inheritance, hierarchy of class<a hidden class=anchor aria-hidden=true href=#inheritance-hierarchy-of-class>#</a></h2><h3 id=inheritance---inheritancetype><code>@Inheritance</code> - InheritanceType<a hidden class=anchor aria-hidden=true href=#inheritance---inheritancetype>#</a></h3><ul><li><code>SINGLE_TABLE</code> - default</li><li><code>JOINED</code></li><li><code>TABLE_PER_CLASS</code> - rare use, not recommend</li></ul><p>These classes are based classes for demo:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Inheritance</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>InheritanceType</span><span class=o>.</span><span class=na>xxxxxx</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Artist</span> <span class=kd>extends</span> <span class=n>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>mastery</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Worker</span> <span class=kd>extends</span> <span class=n>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>workHour</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>------</span><span class=n>main</span><span class=o>------</span>
</span></span><span class=line><span class=cl><span class=n>Person</span> <span class=n>jack</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Person</span><span class=o>();</span>    <span class=c1>// set id 100
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=n>Artist</span> <span class=n>duke</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Artist</span><span class=o>();</span>    <span class=c1>// set id 200
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=n>Worker</span> <span class=n>roy</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Worker</span><span class=o>();</span>     <span class=c1>// set id 300
</span></span></span></code></pre></div><h4 id=single_table-all-classes-in-single-table><code>SINGLE_TABLE</code> all classes in single table<a hidden class=anchor aria-hidden=true href=#single_table-all-classes-in-single-table>#</a></h4><p>We annotated with this value on <code>Person</code> class</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Inheritance</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>InheritanceType</span><span class=o>.</span><span class=na>SINGLE_TABLE</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Resulting in only one table in database:</p><table><thead><tr><th>DTYPE</th><th>id</th><th>name</th><th>mastery</th><th>workHour</th></tr></thead><tbody><tr><td>Person</td><td>100</td><td>Jack</td><td>null</td><td>null</td></tr><tr><td>Artist</td><td>200</td><td>Duke</td><td>Drawing</td><td>null</td></tr><tr><td>Worker</td><td>300</td><td>Roy</td><td>null</td><td>8</td></tr></tbody></table><p>As shown above, there are columns set to <code>null</code>.</p><h4 id=joined---foreign-key-joined-in-1-table><code>JOINED</code> - foreign key joined in 1 table<a hidden class=anchor aria-hidden=true href=#joined---foreign-key-joined-in-1-table>#</a></h4><p><strong>Joined means the foreign key is joined in one table.</strong> This will actually generate 3 tables.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Inheritance</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>InheritanceType</span><span class=o>.</span><span class=na>JOINED</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Person table</p><table><thead><tr><th>id</th><th>name</th></tr></thead><tbody><tr><td>100</td><td>Jack</td></tr><tr><td>200</td><td>Duke</td></tr><tr><td>300</td><td>Roy</td></tr></tbody></table><p>Artist table</p><table><thead><tr><th>id</th><th>mastery</th></tr></thead><tbody><tr><td>200</td><td>Drawing</td></tr></tbody></table><p>Worker table</p><table><thead><tr><th>id</th><th>workHour</th></tr></thead><tbody><tr><td>300</td><td>30</td></tr></tbody></table><p><strong>Drawback:</strong> The disadvantage of this inheritance mapping method is that retrieving entities requires joins between tables. For high queries, it&rsquo;s more likely to affect the performance.</p><h5 id=customize-the-foreign-key-column-by-primarykeyjoincolumnname-->Customize the foreign key column by <code>@PrimaryKeyJoinColumn(name = "")</code><a hidden class=anchor aria-hidden=true href=#customize-the-foreign-key-column-by-primarykeyjoincolumnname-->#</a></h5><p>Each table will share the same name <code>id</code>. If you want to make, for example, Artist table <code>id</code> another name:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@PrimaryKeyJoinColumn</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;artist_id&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Artist</span> <span class=kd>extends</span> <span class=n>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>This will set it name as <code>artist_id</code></p><p>Artist table</p><table><thead><tr><th>artist_id</th><th>mastery</th></tr></thead><tbody><tr><td>200</td><td>Drawing</td></tr></tbody></table><h4 id=table_per_class---create-table-for-each-class-with-all-the-fields><code>TABLE_PER_CLASS</code> - create table for each class with all the fields<a hidden class=anchor aria-hidden=true href=#table_per_class---create-table-for-each-class-with-all-the-fields>#</a></h4><blockquote><p>It maps each entity to its table, which contains all the properties of the entity, including the ones inherited.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Inheritance</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>InheritanceType</span><span class=o>.</span><span class=na>TABLE_PER_CLASS</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Person</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>Person table</p><table><thead><tr><th>id</th><th>name</th></tr></thead><tbody><tr><td>100</td><td>Jack</td></tr></tbody></table><p>Artist table</p><table><thead><tr><th>id</th><th>name</th><th>mastery</th></tr></thead><tbody><tr><td>200</td><td>Duke</td><td>Drawing</td></tr></tbody></table><p>Worker table</p><table><thead><tr><th>id</th><th>name</th><th>workHour</th></tr></thead><tbody><tr><td>300</td><td>Roy</td><td>30</td></tr></tbody></table><p>It&rsquo;s no difference from creating an individual class without inheritance.</p><h3 id=mappedsuperclass><code>@MappedSuperclass</code><a hidden class=anchor aria-hidden=true href=#mappedsuperclass>#</a></h3><p>Create a template like class that works like an entity class. It can be used to remove duplicate code.</p><p>This class has no separated table in database. The mapping information can be override by <code>@AttributeOverride</code> <code>@AssociationOverride</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@MappedSuperclass</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>abstract</span> <span class=kd>class</span> <span class=nc>Vehicle</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span><span class=o>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=o>.</span><span class=na>IDENTITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>color</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>----------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Car</span> <span class=kd>extends</span> <span class=n>Vehicle</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>gas</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>----------</span>
</span></span><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Bicycle</span> <span class=kd>extends</span> <span class=n>Vehicle</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>model</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Car table</p><table><thead><tr><th>id</th><th>color</th><th>gas</th></tr></thead><tbody><tr><td>1</td><td>Blue</td><td>Diesel</td></tr></tbody></table><p>Bicycle table</p><table><thead><tr><th>id</th><th>color</th><th>model</th></tr></thead><tbody><tr><td>1</td><td>Red</td><td>BMAX</td></tr></tbody></table><p>This example put <code>@id</code> in abstract class. In practice, we should put it in the subclass instead. It&rsquo;s because we can define the desired way of primary key strategy.</p><h1 id=entitymanager>EntityManager<a hidden class=anchor aria-hidden=true href=#entitymanager>#</a></h1><h2 id=get-the-entitymanager-by-entitymanagerfactory>Get the <code>EntityManager</code> by <code>EntityManagerFactory</code><a hidden class=anchor aria-hidden=true href=#get-the-entitymanager-by-entitymanagerfactory>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>EntityManagerFactory</span> <span class=n>factory</span> <span class=o>=</span> <span class=n>Persistence</span><span class=o>.</span><span class=na>createEntityManagerFactory</span><span class=o>(</span><span class=s>&#34;my-persistence-unit&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>EntityManager</span> <span class=n>entityManager</span> <span class=o>=</span> <span class=n>factory</span><span class=o>.</span><span class=na>createEntityManager</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>entityManager</span><span class=o>.</span><span class=na>begin</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// persist, flush, etc operations
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=n>entityManager</span><span class=o>.</span><span class=na>commit</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>entityManager</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span></code></pre></div><h2 id=available-entitymanager-methods>Available <code>EntityManager</code> methods<a hidden class=anchor aria-hidden=true href=#available-entitymanager-methods>#</a></h2><ul><li><code>commit()</code> - commit all changes from JPA context to database. When called, it&rsquo;s where the SQL executed</li><li><code>persist()</code></li><li><code>flush()</code> - to persist all data in database before <code>commit()</code> is called</li></ul><h3 id=find><code>find()</code><a hidden class=anchor aria-hidden=true href=#find>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Product</span> <span class=n>product</span> <span class=o>=</span> <span class=n>entityManager</span><span class=o>.</span><span class=na>find</span><span class=o>(</span><span class=n>Product</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=mi>10</span><span class=o>);</span> <span class=c1>// 10 is the primary key id
</span></span></span></code></pre></div><h3 id=getreference><code>getReference()</code><a hidden class=anchor aria-hidden=true href=#getreference>#</a></h3><p>The code is similar.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Product</span> <span class=n>product</span> <span class=o>=</span> <span class=n>entityManager</span><span class=o>.</span><span class=na>getReference</span><span class=o>(</span><span class=n>Product</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=mi>10</span><span class=o>);</span> 
</span></span></code></pre></div><p>But the main difference is <strong>if the object is not used later, the query will not be executed.</strong>
The above code will not execute a <code>SELECT</code> query unless we use the object. e.g. print it in the console.</p><p>This actually use a proxy to check if the object is used.</p><h3 id=contains><code>contains()</code><a hidden class=anchor aria-hidden=true href=#contains>#</a></h3><p>Check if the object is in the JPA context</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Product</span> <span class=n>product</span> <span class=o>=</span> <span class=n>entityManager</span><span class=o>.</span><span class=na>find</span><span class=o>(</span><span class=n>Product</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=mi>10</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=kt>boolean</span> <span class=n>isExist</span> <span class=o>=</span> <span class=n>entityManager</span><span class=o>.</span><span class=na>contains</span><span class=o>(</span><span class=n>product</span><span class=o>);</span>
</span></span></code></pre></div><h3 id=remove><code>remove()</code><a hidden class=anchor aria-hidden=true href=#remove>#</a></h3><p>remove record in database</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Product</span> <span class=n>product</span> <span class=o>=</span> <span class=c1>// get product
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>entityManager</span><span class=o>.</span><span class=na>remove</span><span class=o>(</span><span class=n>product</span><span class=o>);</span>  <span class=c1>// execute delete query
</span></span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://derry.club/tags/jpa/>jpa</a></li><li><a href=https://derry.club/tags/java/>java</a></li><li><a href=https://derry.club/tags/database/>database</a></li><li><a href=https://derry.club/tags/annotations/>annotations</a></li><li><a href=https://derry.club/tags/cheat-sheet/>cheat sheet</a></li><li><a href=https://derry.club/tags/data/>data</a></li><li><a href=https://derry.club/tags/persistence/>persistence</a></li><li><a href=https://derry.club/tags/table/>table</a></li></ul><nav class=paginav><a class=next href=https://derry.club/posts/docker-cheatsheet/><span class=title>Next »</span><br><span>Docker Cheat sheet, a general cheat sheet for all use case</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Jpa Cheat Sheet for annotations on twitter" href="https://twitter.com/intent/tweet/?text=Jpa%20Cheat%20Sheet%20for%20annotations&url=https%3a%2f%2fderry.club%2fposts%2fjava%2fjpa-cheat-sheet%2f&hashtags=jpa%2cjava%2cdatabase%2cannotations%2ccheatsheet%2cdata%2cpersistence%2ctable"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Jpa Cheat Sheet for annotations on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fderry.club%2fposts%2fjava%2fjpa-cheat-sheet%2f&title=Jpa%20Cheat%20Sheet%20for%20annotations&summary=Jpa%20Cheat%20Sheet%20for%20annotations&source=https%3a%2f%2fderry.club%2fposts%2fjava%2fjpa-cheat-sheet%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Jpa Cheat Sheet for annotations on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fderry.club%2fposts%2fjava%2fjpa-cheat-sheet%2f&title=Jpa%20Cheat%20Sheet%20for%20annotations"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Jpa Cheat Sheet for annotations on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fderry.club%2fposts%2fjava%2fjpa-cheat-sheet%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Jpa Cheat Sheet for annotations on whatsapp" href="https://api.whatsapp.com/send?text=Jpa%20Cheat%20Sheet%20for%20annotations%20-%20https%3a%2f%2fderry.club%2fposts%2fjava%2fjpa-cheat-sheet%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Jpa Cheat Sheet for annotations on telegram" href="https://telegram.me/share/url?text=Jpa%20Cheat%20Sheet%20for%20annotations&url=https%3a%2f%2fderry.club%2fposts%2fjava%2fjpa-cheat-sheet%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://derry.club/>Derry Dev Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>